{"version":3,"sources":["main.js"],"names":["app","PIXI","Application","view","document","getElementById","width","height","transparent","app2","backgroundColor","rt","RenderTexture","create","rt2","renderSprite","Sprite","manifest","loadAssets","loader","add","load","onAssetsLoaded","resources","console","log","displacementTile","setupStage2","renderCircle","ticker","e","update","window","bg","buildings","texture","stage","addChild","displacement2","baseTexture","wrapMode","WRAP_MODES","REPEAT","displaceSprite","displaceFilter","filters","DisplacementFilter","TweenMax","fromTo","scale","x","y","ease","Sine","easeInOut","Linear","easeNone","repeat","blur","BlurFilter","circle","Graphics","beginFill","drawCircle","easeOut","yoyo","onRepeat","Math","random","temp","renderer","render","resize","canvasAspect","screen","screenAspect","innerWidth","innerHeight","newTransform","style","transform","onload","addEventListener"],"mappings":"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","file":"main.js","sourcesContent":["let app = new PIXI.Application({\n\tview: document.getElementById(\"pixiCanvas\"),\n\twidth: 1024,\n\theight: 1280,\n\ttransparent: true\n});\n\nlet app2 = new PIXI.Application({\n\tview: document.getElementById(\"backgroundCanvas\"),\n\twidth: 1280,\n\theight: 720,\n\tbackgroundColor: 0x444444\n});\n\nlet rt = PIXI.RenderTexture.create(1280, 720);\nlet rt2 = PIXI.RenderTexture.create(1280, 720);\nlet renderSprite = new PIXI.Sprite(rt);\n\nlet manifest = [\n\t{\"key\" : \"ball\", \"url\" : \"dist/img/logo.png\"},\n\t{\"key\" : \"buildings\", \"url\" : \"dist/img/pierre-chatel-innocenti-1286583-unsplash.jpg\"},\n\t{\"key\" : \"displacement2\", \"url\" : \"dist/img/displacement2.png\"},\n\t{\"key\" : \"displacement3\", \"url\" : \"dist/img/displacement3.png\"}\n\t\n];\n\nfunction loadAssets() {\n\tapp.loader.add(manifest);\n\n\tapp.loader.load(onAssetsLoaded);\n}\n\nfunction onAssetsLoaded(loader, resources) {\n\tconsole.log(resources);\n\n\tdisplacementTile();\n\n\tsetupStage2();\n\n\trenderCircle();\n\n\tapp.ticker.add((e) => update(e));\n}\n\nfunction displacementTile() {\n\t// setup main image\n\twindow.bg = new PIXI.Sprite(app.loader.resources.buildings.texture);\n\tapp.stage.addChild(bg);\n\n\t// set texture to tile\n\tapp.loader.resources.displacement2.texture.baseTexture.wrapMode\t= PIXI.WRAP_MODES.REPEAT;\n\t// add displacement image\n\tlet displaceSprite = new PIXI.Sprite(app.loader.resources.displacement2.texture, 2048, 1920);\n\n\tapp.stage.addChild(displaceSprite);\n\n\tlet displaceFilter = new PIXI.filters.DisplacementFilter(displaceSprite);\n\tbg.filters = [displaceFilter];\n\n\tTweenMax.fromTo(displaceFilter.scale, 6, {x: 0, y: 0}, {x: 20, y: 20, ease: Sine.easeInOut});\n\tTweenMax.fromTo(displaceSprite, 10, \n\t\t{x: -1024, y: 0}, \n\t\t{x: 0, y: -640, ease: Linear.easeNone, repeat: -1});\n}\n\nfunction setupStage2 () {\n\tapp2.stage.addChild(renderSprite);\n\n\tlet blur = new PIXI.filters.BlurFilter();\n\t// app2.stage.filters = [blur];\n}\n\nfunction renderCircle () {\n\n\tlet circle = new PIXI.Graphics();\n\tcircle.beginFill(0x00ffcc, 0.1);\n\tcircle.drawCircle(0, 0, 50);\n\tcircle.x = 900;\n\tcircle.y = 600;\n\n\tapp2.stage.addChild(circle);\n\n\tTweenMax.fromTo(circle, 8, \n\t\t{\n\t\t\tx: -50\n\t\t}, {\n\t\t\tx: 1330, \n\t\t\tease: Sine.easeOut, \n\t\t\trepeat: -1,\n\t\t\tyoyo: true,\n\t\t\tonRepeat: function() {\n\t\t\t\tcircle.y = Math.random() * 720;\n\t\t\t}\n\t\t});\n}\n\nfunction update(e) {\n\tlet temp = rt;\n\trt = rt2;\n\trt2 = temp;\n\trenderSprite.texture = rt;\n\n\tapp2.renderer.render(app2.stage, rt2);\n}\n\nfunction resize(e) {\n\tconsole.log(\"resize\");\n\t// resize canvas to center cut\n\tlet canvasAspect = app2.screen.width / app2.screen.height;\n\tlet screenAspect = window.innerWidth / window.innerHeight;\n\tlet scale = 1;\n\n\tif (screenAspect >= canvasAspect) {\n\t\t// if screen > canvas, screen is wider\n\t\t// landscape, make width match\n\t\tscale = window.innerWidth / app2.screen.width;\n\t} else {\n\t\t// else canvas is wider, so make height match\n\t\t// portrait, make height match\n\t\tscale = window.innerHeight / app2.screen.height;\n\t}\n\n\tlet newTransform = 'scale(' + scale + ')';\n\n\tapp2.view.style.transform = newTransform;\n}\n\nwindow.onload = function() {\n\twindow.addEventListener(\"resize\", resize);\n\tresize();\n\n\tloadAssets();\n}"]}